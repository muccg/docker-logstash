logspout:
    image: gliderlabs/logspout
    command: syslog://logstash:5140
    volumes:
      - /var/run/docker.sock:/tmp/docker.sock
    links:
      - logstash

kibana:
    build: kibana/
    command: kibana
    ports:
      - "5601:5601"
    links:
      - elasticsearch
    environment:
      - WAIT_FOR_ELASTICSEARCH=1

elasticsearch:
    build: elasticsearch/
    command: elasticsearch
    volumes:
      - data/elasticsearch:/opt/elasticsearch/data
    ports:
      - ":9200"
      - ":9300"

logstash:
    build: logstash/
    command: logstash
    volumes:
      - data/logstash/data:/opt/logstash/data
      - data/logstash/logs:/opt/logstash/logs
    links:
      - elasticsearch
    ports:
      - "5140:5140"
      - "5140:5140/udp"
      - ":514"
      - ":514/udp"
      - ":5959"
      - ":5959/udp"

nginx:
    build: nginx/
    command: nginx
    environment:
      - WAIT_FOR_KIBANA=1
    ports:
      - "8443:443"
    links:
      - kibana
